import{m as N,W as s,d as c,S as l}from"./moto1-DEPS2biy.js";import{B as e,a as d}from"./index-BGhFIEda.js";class w extends e{body=new e({tagName:"tbody"});win;time;constructor(t){super({tagName:"table",className:"table"});const a=new e({tagName:"thead"}),i=new e({tagName:"tr"}),n=[new e({tagName:"th",className:"thead",textContent:"Number"}),new e({tagName:"th",className:"thead",textContent:"Car"}),new e({tagName:"th",className:"thead",textContent:"Name"}),this.win=new e({tagName:"th",className:"thead",textContent:"Wins"}),this.time=new e({tagName:"th",className:"thead",textContent:"Best time"})];i.appendChildren(n),a.append(i),this.append(a),this.append(this.body),this.win.addListener("click",r=>{r.preventDefault(),t("wins")}),this.time.addListener("click",r=>{r.preventDefault(),t("time")})}get bodyNode(){return this.body}}class b extends e{constructor(t,a,i,n,r){super({tagName:"tr",className:"table-row"});const u=new e({tagName:"td",className:"table-cell",textContent:`${t}`}),o=new e({tagName:"td",className:"table-cell"});o.setHTML(N),o.setStyle("fill",i);const m=new e({tagName:"td",className:"table-cell",textContent:`${a}`}),g=new e({tagName:"td",className:"table-cell",textContent:`${n}`}),p=new e({tagName:"td",className:"table-cell",textContent:`${r}`});this.appendChildren([u,o,m,g,p])}}class v extends e{currentPage=s.saveValues.currentPage;countPages=1;header=new e({tagName:"h2",className:"title",textContent:"Winners ()"});pageNumber=new e({tagName:"h3",className:"page-number",textContent:"Page #"});prevButton=new d({className:"control-button prev-button",textContent:"PREV"});nextButton=new d({className:"control-button next-button",textContent:"NEXT"});winnersTable;onWinnersCountChange;winnersRows=[];sortOrder="ASC";constructor(){super({tagName:"div",className:"winners-wrapper"}),this.prevButton.addClass("disabled");const t=new e({tagName:"div",className:"control-button-wrapper"});t.appendChildren([this.pageNumber,this.prevButton,this.nextButton]),this.winnersTable=new w(this.sortWinner),this.appendChildren([this.header,t,this.winnersTable]),this.onWinnersCountChange=a=>{this.header.setTextContent(`Winners (${a})`),this.countPages=Math.ceil(a/c),this.updatePageTitle(),this.checkPrevButton(),this.checkNextButton()},s.winnersCount.subscribe(this.onWinnersCountChange),this.createWinners(s.saveValues.sort.field,s.saveValues.sort.order).then(()=>{}).catch(()=>{}),this.nextPage(),this.prevPage()}async createWinners(t,a){const i=await s.getWinners(this.currentPage,t,a);this.winnersRows=i.map((n,r)=>new b((this.currentPage-1)*c+r+1,n.name,n.color,n.wins,n.time)),this.winnersTable.bodyNode.appendChildren([...this.winnersRows])}updatePageTitle=()=>{this.pageNumber.setTextContent(`Page #${this.currentPage}`)};checkPrevButton=()=>{this.prevButton.toggleClass("disabled",this.currentPage===l)};checkNextButton=()=>{this.nextButton.toggleClass("disabled",this.currentPage===this.countPages)};updateTracks(t,a){this.winnersTable.bodyNode.destroyChildren(),this.createWinners(t,a).then(()=>{}).catch(()=>{}),this.checkPrevButton(),this.checkNextButton()}nextPage=()=>{this.nextButton.addListener("click",t=>{t.preventDefault(),this.checkNextButton(),this.prevButton.removeClass("disabled"),this.currentPage+=1,s.saveValues.currentPage=this.currentPage,this.updatePageTitle(),this.updateTracks(s.saveValues.sort.field,s.saveValues.sort.order)})};prevPage=()=>{this.prevButton.addListener("click",t=>{t.preventDefault(),this.currentPage===l+1&&this.prevButton.addClass("disabled"),this.nextButton.removeClass("disabled"),this.currentPage-=1,s.saveValues.currentPage=this.currentPage,this.updatePageTitle(),this.updateTracks(s.saveValues.sort.field,s.saveValues.sort.order)})};sortWinner=t=>{this.sortOrder=this.sortOrder==="ASC"?"DESC":"ASC",s.saveValues.sort.field=t,s.saveValues.sort.order=this.sortOrder,this.updateTracks(t,this.sortOrder)}}export{v as WinnersPage};
