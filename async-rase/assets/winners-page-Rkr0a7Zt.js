import{m as w,w as n,d as c,S as l}from"./moto1-6ervAdsX.js";import{B as e,a as d}from"./index-DQF5Xbws.js";class b extends e{body=new e({tag:"tbody"});win;time;constructor(t){super({tag:"table",className:"table"});const s=new e({tag:"thead"}),a=new e({tag:"tr"}),r=[new e({tag:"th",className:"thead",textContent:"Number"}),new e({tag:"th",className:"thead",textContent:"Car"}),new e({tag:"th",className:"thead",textContent:"Name"}),this.win=new e({tag:"th",className:"thead",textContent:"Wins"}),this.time=new e({tag:"th",className:"thead",textContent:"Best time"})];a.appendChildren(r),s.append(a),this.append(s),this.append(this.body),this.win.addListener("click",i=>{i.preventDefault(),t("wins")}),this.time.addListener("click",i=>{i.preventDefault(),t("time")})}get bodyNode(){return this.body}}class C extends e{constructor(t,s,a,r,i){super({tag:"tr",className:"table-row"});const u=new e({tag:"td",className:"table-cell",textContent:`${t}`}),o=new e({tag:"td",className:"table-cell"});o.setHTML(w),o.setStyle("fill",a);const g=new e({tag:"td",className:"table-cell",textContent:`${s}`}),p=new e({tag:"td",className:"table-cell",textContent:`${r}`}),m=new e({tag:"td",className:"table-cell",textContent:`${i}`});this.appendChildren([u,o,g,p,m])}}class v extends e{currentPage=n.saveValues.currentPage;countPages=1;header=new e({tag:"h2",className:"title",textContent:"Winners ()"});pageNumber=new e({tag:"h3",className:"page-number",textContent:"Page #"});prevButton=new d({className:"control-button prev-button",textContent:"PREV"});nextButton=new d({className:"control-button next-button",textContent:"NEXT"});winnersTable;onWinnersCountChange;winnersRows=[];sortOrder="ASC";constructor(){super({tag:"div",className:"winners-wrapper"}),this.prevButton.addClass("disabled");const t=new e({tag:"div",className:"control-button-wrapper"});t.appendChildren([this.pageNumber,this.prevButton,this.nextButton]),this.winnersTable=new b(this.sortWinner),this.appendChildren([this.header,t,this.winnersTable]),this.onWinnersCountChange=s=>{this.header.setTextContent(`Winners (${s})`),this.countPages=Math.ceil(s/c),this.updatePageTitle(),this.checkPrevButton(),this.checkNextButton()},n.winnersCount.subscribe(this.onWinnersCountChange),this.createWinners(n.saveValues.sort.field,n.saveValues.sort.order).then(()=>{}).catch(s=>{throw new Error(s.message)}),this.nextPage(),this.prevPage()}async createWinners(t,s){const a=await n.getWinners(this.currentPage,t,s);this.winnersRows=a.map((r,i)=>new C((this.currentPage-1)*c+i+1,r.name,r.color,r.wins,r.time)),this.winnersTable.bodyNode.appendChildren([...this.winnersRows])}updatePageTitle=()=>{this.pageNumber.setTextContent(`Page #${this.currentPage}`)};checkPrevButton=()=>{this.prevButton.toggleClass("disabled",this.currentPage===l)};checkNextButton=()=>{this.nextButton.toggleClass("disabled",this.currentPage===this.countPages)};updateTracks(t,s){this.winnersTable.bodyNode.destroyChildren(),this.createWinners(t,s).then(()=>{}).catch(a=>{throw new Error(a.message)}),this.checkPrevButton(),this.checkNextButton()}nextPage=()=>{this.nextButton.addListener("click",t=>{t.preventDefault(),this.checkNextButton(),this.prevButton.removeClass("disabled"),this.currentPage+=1,n.saveValues.currentPage=this.currentPage,this.updatePageTitle(),this.updateTracks(n.saveValues.sort.field,n.saveValues.sort.order)})};prevPage=()=>{this.prevButton.addListener("click",t=>{t.preventDefault(),this.currentPage===l+1&&this.prevButton.addClass("disabled"),this.nextButton.removeClass("disabled"),this.currentPage-=1,n.saveValues.currentPage=this.currentPage,this.updatePageTitle(),this.updateTracks(n.saveValues.sort.field,n.saveValues.sort.order)})};sortWinner=t=>{this.sortOrder=this.sortOrder==="ASC"?"DESC":"ASC",n.saveValues.sort.field=t,n.saveValues.sort.order=this.sortOrder,this.updateTracks(t,this.sortOrder)}}export{v as WinnersPage};
